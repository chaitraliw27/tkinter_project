import pandas as pd

# Creating the initial DataFrame
data = {
    'node_name': ['BFN', 'BFN', 'Wholesale', 'Wholesale', 'Security', 'Security'],
    'in_jira': [True, True, True, True, False, False],
    'in_prod': [True, True, True, True, True, True],
    'in_both': [True, True, False, False, False, False],
    'Link': ['html link_BFN', 'html link_BFN', 'html link_Wholesale', 'html link_Wholesale', 'html link_Security', 'html link_Security']
}

df = pd.DataFrame(data)

# Group by node_name and count the occurrences of True values
result = df.groupby('node_name').agg(
    in_jira=('in_jira', 'sum'),
    in_prod=('in_prod', 'sum'),
    in_both=('in_both', 'sum'),
    Link=('Link', 'first')
).reset_index()

# Display the result
print(result)
